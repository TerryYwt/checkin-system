import{_ as X,b as Y,r as d,c as Z,o as $,d as n,e as ee,f as g,g as S,h as t,w as l,E as b,j as s,k as u,F as te,p as le,q as ae,l as oe,m as U,t as _,s as ne,v as se}from"./index-a9930cd6.js";const re={class:"reports-container"},de={class:"stat-title"},ue={class:"stat-value"},ie={class:"card-header"},ce={class:"card-header"},pe={class:"table-actions"},_e={class:"pagination-container"},me={__name:"MerchantReports",setup(ve){const i=Y({dateRange:[],status:""}),T=[{text:"最近一週",value:()=>{const a=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*7),[e,a]}},{text:"最近一個月",value:()=>{const a=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*30),[e,a]}},{text:"最近三個月",value:()=>{const a=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*90),[e,a]}}],M=d([{title:"總到店人數",value:"234",trend:15},{title:"完成率",value:"85%",trend:5},{title:"平均處理時間",value:"45分鐘",trend:-10},{title:"轉換率",value:"60%",trend:8}]),k=d("day"),w=d(!1),m=d(""),y=d(1),h=d(20),N=d(0),z=d([]),B=Z(()=>{if(!m.value)return z.value;const a=m.value.toLowerCase();return z.value.filter(e=>{var f;return e.customerName.toLowerCase().includes(a)||e.phone.includes(a)||((f=e.note)==null?void 0:f.toLowerCase().includes(a))})}),L=a=>({arrived:"primary",trying:"warning",completed:"success",cancelled:"info"})[a]||"info",E=a=>({arrived:"已到店",trying:"試戴中",completed:"已完成",cancelled:"已取消"})[a]||a,v=async()=>{w.value=!0;try{b.success("數據已更新")}catch{b.error("更新數據失敗")}finally{w.value=!1}},F=async()=>{try{b.success("報表導出成功")}catch{b.error("導出報表失敗")}},j=a=>{h.value=a,v()},q=a=>{y.value=a,v()};return $(async()=>{i.dateRange=T[1].value(),await v()}),(a,e)=>{const f=n("el-date-picker"),x=n("el-form-item"),c=n("el-option"),P=n("el-select"),D=n("el-button"),I=n("el-form"),p=n("el-card"),V=n("el-col"),R=n("el-row"),C=n("el-radio-button"),Q=n("el-radio-group"),A=n("el-icon"),G=n("el-input"),r=n("el-table-column"),H=n("el-tag"),J=n("el-table"),K=n("el-pagination"),O=ee("loading");return g(),S("div",re,[t(p,{class:"filter-card"},{header:l(()=>e[6]||(e[6]=[s("div",{class:"card-header"},[s("span",null,"數據篩選")],-1)])),default:l(()=>[t(I,{inline:!0,model:i},{default:l(()=>[t(x,{label:"時間範圍"},{default:l(()=>[t(f,{modelValue:i.dateRange,"onUpdate:modelValue":e[0]||(e[0]=o=>i.dateRange=o),type:"daterange","range-separator":"至","start-placeholder":"開始日期","end-placeholder":"結束日期",shortcuts:T},null,8,["modelValue"])]),_:1}),t(x,{label:"狀態"},{default:l(()=>[t(P,{modelValue:i.status,"onUpdate:modelValue":e[1]||(e[1]=o=>i.status=o),placeholder:"選擇狀態"},{default:l(()=>[t(c,{label:"全部",value:""}),t(c,{label:"已到店",value:"arrived"}),t(c,{label:"試戴中",value:"trying"}),t(c,{label:"已完成",value:"completed"}),t(c,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),t(x,null,{default:l(()=>[t(D,{type:"primary",onClick:v},{default:l(()=>e[7]||(e[7]=[u("更新數據")])),_:1}),t(D,{onClick:F},{default:l(()=>e[8]||(e[8]=[u("導出報表")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(R,{gutter:20,class:"mt-4"},{default:l(()=>[(g(!0),S(te,null,le(M.value,(o,W)=>(g(),U(V,{span:6,key:W},{default:l(()=>[t(p,{shadow:"hover",class:"stat-card"},{default:l(()=>[s("div",de,_(o.title),1),s("div",ue,_(o.value),1),s("div",{class:ne(["stat-trend",o.trend>0?"up":"down"])},[u(_(o.trend>0?"+":"")+_(o.trend)+"% ",1),e[9]||(e[9]=s("span",{class:"trend-label"},"較上期",-1))],2)]),_:2},1024)]),_:2},1024))),128))]),_:1}),t(R,{gutter:20,class:"mt-4"},{default:l(()=>[t(V,{span:12},{default:l(()=>[t(p,null,{header:l(()=>[s("div",ie,[e[13]||(e[13]=s("span",null,"到店趨勢",-1)),t(Q,{modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=o=>k.value=o),size:"small"},{default:l(()=>[t(C,{label:"day"},{default:l(()=>e[10]||(e[10]=[u("日")])),_:1}),t(C,{label:"week"},{default:l(()=>e[11]||(e[11]=[u("週")])),_:1}),t(C,{label:"month"},{default:l(()=>e[12]||(e[12]=[u("月")])),_:1})]),_:1},8,["modelValue"])])]),default:l(()=>[e[14]||(e[14]=s("div",{class:"chart-container"},null,-1))]),_:1})]),_:1}),t(V,{span:12},{default:l(()=>[t(p,null,{header:l(()=>e[15]||(e[15]=[s("div",{class:"card-header"},[s("span",null,"轉換漏斗")],-1)])),default:l(()=>[e[16]||(e[16]=s("div",{class:"chart-container"},null,-1))]),_:1})]),_:1})]),_:1}),t(p,{class:"mt-4"},{header:l(()=>[s("div",ce,[e[17]||(e[17]=s("span",null,"詳細數據",-1)),s("div",pe,[t(G,{modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=o=>m.value=o),placeholder:"搜索",style:{width:"200px"},clearable:""},{prefix:l(()=>[t(A,null,{default:l(()=>[t(ae(se))]),_:1})]),_:1},8,["modelValue"])])])]),default:l(()=>[oe((g(),U(J,{data:B.value,style:{width:"100%"},border:""},{default:l(()=>[t(r,{prop:"date",label:"日期",width:"180",sortable:""}),t(r,{prop:"customerName",label:"顧客姓名",width:"120"}),t(r,{prop:"phone",label:"電話",width:"120"}),t(r,{prop:"status",label:"狀態",width:"100"},{default:l(({row:o})=>[t(H,{type:L(o.status)},{default:l(()=>[u(_(E(o.status)),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"arrivalTime",label:"到店時間",width:"180",sortable:""}),t(r,{prop:"completionTime",label:"完成時間",width:"180",sortable:""}),t(r,{prop:"duration",label:"處理時長",width:"120",sortable:""}),t(r,{prop:"note",label:"備註","show-overflow-tooltip":""})]),_:1},8,["data"])),[[O,w.value]]),s("div",_e,[t(K,{"current-page":y.value,"onUpdate:currentPage":e[4]||(e[4]=o=>y.value=o),"page-size":h.value,"onUpdate:pageSize":e[5]||(e[5]=o=>h.value=o),"page-sizes":[10,20,50,100],total:N.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:j,onCurrentChange:q},null,8,["current-page","page-size","total"])])]),_:1})])}}},ge=X(me,[["__scopeId","data-v-a5c6c4ca"]]);export{ge as default};
