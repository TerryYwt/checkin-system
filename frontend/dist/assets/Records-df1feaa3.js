import{_ as E,r,o as F,d as o,e as L,f as p,g as w,j as v,h as t,w as s,l as P,m as R,i as C,E as I,F as $,p as j,k as f,t as W}from"./index-368b849d.js";const q={class:"records"},A={class:"search-form"},G={class:"pagination"},H={__name:"Records",setup(J){const n=r({userId:"",dateRange:[]}),h=r([]),b=r([]),u=r(!1),_=r(1),m=r(10),y=r(0),S=async()=>{try{const l=await C.get("/api/users");b.value=l.data}catch{I.error("獲取用戶列表失敗")}},z=l=>new Date(l).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),d=async()=>{var l;u.value=!0;try{const e=new URLSearchParams;n.value.userId&&e.append("userId",n.value.userId),((l=n.value.dateRange)==null?void 0:l.length)===2&&(e.append("startDate",n.value.dateRange[0]),e.append("endDate",n.value.dateRange[1]));const i=await C.get(`/api/checkin-records?${e.toString()}`);h.value=i.data,y.value=i.data.length}catch(e){I.error("搜索失敗："+e.message)}finally{u.value=!1}},D=()=>{n.value={userId:"",dateRange:[]},d()},V=l=>{m.value=l,d()},x=l=>{_.value=l,d()};return F(()=>{S(),d()}),(l,e)=>{const i=o("el-option"),U=o("el-select"),g=o("el-form-item"),T=o("el-date-picker"),k=o("el-button"),B=o("el-form"),c=o("el-table-column"),M=o("el-table"),N=o("el-pagination"),Y=L("loading");return p(),w("div",q,[e[6]||(e[6]=v("h2",null,"簽到記錄",-1)),v("div",A,[t(B,{inline:!0,model:n.value},{default:s(()=>[t(g,{label:"用戶"},{default:s(()=>[t(U,{modelValue:n.value.userId,"onUpdate:modelValue":e[0]||(e[0]=a=>n.value.userId=a),placeholder:"請選擇用戶",clearable:""},{default:s(()=>[(p(!0),w($,null,j(b.value,a=>(p(),R(i,{key:a.id,label:`${a.name} (${a.department})`,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(g,{label:"日期範圍"},{default:s(()=>[t(T,{modelValue:n.value.dateRange,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"開始日期","end-placeholder":"結束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),t(g,null,{default:s(()=>[t(k,{type:"primary",onClick:d,loading:u.value},{default:s(()=>e[4]||(e[4]=[f("搜索")])),_:1},8,["loading"]),t(k,{onClick:D},{default:s(()=>e[5]||(e[5]=[f("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),P((p(),R(M,{data:h.value,style:{width:"100%"}},{default:s(()=>[t(c,{prop:"userName",label:"姓名",width:"120"}),t(c,{prop:"department",label:"部門",width:"120"}),t(c,{prop:"checkInTime",label:"簽到時間",width:"180"},{default:s(({row:a})=>[f(W(z(a.checkInTime)),1)]),_:1}),t(c,{prop:"note",label:"備註"})]),_:1},8,["data"])),[[Y,u.value]]),v("div",G,[t(N,{"current-page":_.value,"onUpdate:currentPage":e[2]||(e[2]=a=>_.value=a),"page-size":m.value,"onUpdate:pageSize":e[3]||(e[3]=a=>m.value=a),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next",total:y.value,onSizeChange:V,onCurrentChange:x},null,8,["current-page","page-size","total"])])])}}},O=E(H,[["__scopeId","data-v-b4fbd27a"]]);export{O as default};
